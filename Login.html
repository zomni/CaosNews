<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro</title>
    <link href="Style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="jquery.js"></script>
    <title>Iniciar sesión con Google y Registro</title>
    <style>
        .boton-google {
            display: inline-flex;
            align-items: center;
            background-color: #4285F4;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }
        .boton-google img {
            margin-right: 10px;
        }
    </style>
</head>
<body class="fondo">
    <!--NavBar-->
    <nav class="navbar navbar-expand-lg navbar-light bg-fondo fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="CaosNew.html"><img src="Imagenes/caos news (1).png" height="50" width="100">CaosNews</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="CaosNew.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Contacto.html">Contactanos</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Noticias
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="Deporte.html">Deporte</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="Tecnologia.html">Tecnologia</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="Politica.html">Politica</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="darkModeSwitch" onclick="modooscuro()">
                            <label class="form-check-label" for="darkModeSwitch">Modo oscuro</label>
                        </div>
                    </li>
                </ul>
                <form class="d-flex navbar-search-margin" role="search">
                    <input class="form-control me-2" type="search" placeholder="Buscar..." aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">Buscar</button>
                </form>
                <li class="nav-item" id="loginLink">
                    <a class="nav-link" href="Login.html">Login</a>
                </li>
                <div class="nav-item dropdown" id="userDropdown" style="display: none;">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="userName"></span>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="NoticiasUsuario.html">Sus noticias</a></li>
                        <li><a class="dropdown-item" href="#" id="logoutBtn">Cerrar sesión</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <!--Fin del NavBar-->
    <!-- Formulario de registro -->
    <div class="login">
        <div class="centrar">
            <h2 class="h2">Regístrate</h2>
            <form id="miFormulario">
                <label>*Nombre: </label> <br>
                <input type="text" id="itNombre" class="campo" placeholder="Ingrese un nombre">
                <div id="mensaje1" class="errores">Ingrese un Nombre Válido</div> <br>

                <label>*Correo Electrónico: </label> <br/>
                <input type="text" id="itMail" class="campo" placeholder="Ingrese su correo">
                <br/>
                <div id="mensaje2" class="errores">Ingrese un correo válido</div>

                <label>*Contraseña: </label> <br/>
                <input type="password" id="itContraseña" class="campo" placeholder="Ingrese su contraseña">
                <br/>
                <div id="mensaje3" class="errores">Ingrese una contraseña válida</div>

                <input type="submit" id="bEnviar" value="Enviar datos" class="boton"/><br/>
            </form>
        </div>
    </div>

    <!-- Botón de inicio de sesión con Google -->
    <div>
        <button id="googleSignInBtn" class="boton-google">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png" alt="Google Logo" width="20" height="20">
            Iniciar sesión con Google
        </button>
    </div>

    <!-- Integración de Firebase -->
    <script type="module">
        // Importar las funciones necesarias de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBW7x_t5T_A6i5JjN8vrzeMJymtLwTbVmI",
            authDomain: "paolojoshuaagus.firebaseapp.com",
            projectId: "paolojoshuaagus",
            storageBucket: "paolojoshuaagus.appspot.com",
            messagingSenderId: "433525660740",
            appId: "1:433525660740:web:76df18cb562ea8bfe03011",
            measurementId: "G-T8C1SM0RFW"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);

        // Configuración del proveedor de Google
        const provider = new GoogleAuthProvider();

        // Función para iniciar sesión con Google
        document.getElementById('googleSignInBtn').addEventListener('click', async () => {
            try {
                const result = await signInWithPopup(auth, provider);
                // El usuario ha iniciado sesión correctamente
                const user = result.user;
                console.log('Usuario autenticado:', user);

                // Guardar el nombre del usuario en localStorage
                localStorage.setItem('loggedIn', 'true');
                localStorage.setItem('userName', user.displayName);

                // Mostrar mensaje de bienvenida
                alert(`Bienvenido ${user.displayName}`);

                // Redirigir a la página principal
                window.location.href = "CaosNew.html";
            } catch (error) {
                console.error('Error al iniciar sesión:', error);
                alert(`Error al iniciar sesión: ${error.message}`);
            }
        });
    </script>

    <!--Footer-->
    <footer class="footer">
        <p>© 2024 CaosNews. Todos los derechos reservados.</p>
    </footer>
    <!--Fin del Footer-->
</body>
</html>
